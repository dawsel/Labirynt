using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Drawing;
using System.Windows.Forms;

namespace Labirynt
{
    class TEST :Gra
    {
        Sprite2D player;

        bool left, right, up, down;
        Vector2 lastPos = Vector2.Zero();
        

        string[,] Map1 =
        {
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
          {"w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".","p",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".","w","w","w","w","w","w","w","w","w",".",".","w","w","w","w","w","w","w","w","w","w","w","w","w",".",".","w","w","w","w","w","w","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w","w","w",".",".","w","w","w","w","w",".",".","w",".",".","w","w","w","w",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w","w","w","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".","w","w","w","w","w","w","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w",".",".",".","w","w","w","w",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".","w","w","w","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w","w","w","w","w","w",".",".",".","w",".",".","w",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w","w","w","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".","w","w","w",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".","w","w","w","w","w","w","w","w","w","w",".",".","w",".",".",".","w",".",".","w","w","w","w",".",".","w",".",".",".",".","w","w","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".","f",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
         };

        string[,] Map2 =
        {
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
          {"w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".","p",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".","w","w","w","w","w","w","w","w","w",".",".","w","w","w",".","w","w","w","w","w","w","w","w","w",".",".","w","w","w","w","w","w","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w","w","w",".",".","w","w","w","w","w",".",".","w",".",".","w","w","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w","w","w","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w","w","w","w","w","w","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w","w",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w","w","w","w","w","w","w","w","w",".",".","w","w","w","w","w","w","w","w","w","w",".",".",".","w","w","w","w",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".","w","w","w","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".","w","w","w","w","w","w","w","w","w","w","w","w","w","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w","w","w","w","w","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w","w","w","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".","w","w","w",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".","w","w","w","w","w","w","w","w","w","w",".",".","w",".",".",".",".",".",".","w","w","w","w",".",".","w",".",".",".",".","w","w","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".","w",".",".",".",".",".",".","w",".","f",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
         };

        string[,] Map3 =
       {
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".","p",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w","w","w",".","w","w","w","w","w","w","w","w","w",".",".","w","w","w","w","w","w","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w","w","w",".",".","w","w","w","w","w",".",".",".",".",".","w","w","w",".",".",".","w",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w","w","w","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".","w","w","w","w","w","w","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".","w","w",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w","w","w",".","w","w","w","w","w",".",".","w","w","w","w","w","w","w","w","w","w",".",".",".","w","w","w","w",".",".","w" },
          {"w",".","w",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".","w","w","w","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".","w","w","w","w","w","w","w","w","w","w","w","w","w","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w",".",".",".",".","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w",".",".","w" },
          {"w","w","w","w","w","w",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".",".",".",".",".",".","w",".",".","w","w","w","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".","w",".",".","w","w","w",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".","w",".",".",".",".",".","w",".",".",".",".",".",".",".",".",".","w",".",".","w",".",".",".",".","w",".",".",".",".",".","w" },
          {"w",".",".","w","w","w","w","w","w","w","w","w",".",".",".","w",".",".",".",".",".",".","w","w","w","w",".",".","w",".",".",".",".","w","w","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".","w",".",".",".",".",".",".","w",".","f",".","w" },
          {"w",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","w",".",".",".",".",".",".","w",".",".",".","w" },
          {"w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w","w" },
         };
        public TEST(): base(new Vector2(1295,1024),"Labirynt Demo") { }


        public override void OnLoad()
        {
            BackgroundColor = Color.Beige;
            
            //CameraPosition.X = 100;
          Sprite2D wallRef = new Sprite2D( "Tiles/tile_0040");
          Sprite2D playerRef = new Sprite2D("Tiles/tile_0097");
          Sprite2D finishRef = new Sprite2D("Tiles/tile_0089");
            //player = new Ksztalt2D(new Vector2(10, 10), new Vector2(10, 10), "Test");
            //player = new Sprite2D(new Vector2(32, 32), new Vector2(30,30 ),"Tiles/tile_0097", "Player");
            if (level == 1)
            {
                for (int i = 0; i < Map1.GetLength(0); i++)
                {
                    for (int j = 0; j < Map1.GetLength(1); j++)
                    {
                        if (Map1[i, j] == "p")
                        {
                            player = new Sprite2D(new Vector2(32, 32), new Vector2(30, 30), playerRef, "Player");
                        }

                        if (Map1[i, j] == "w")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32), wallRef, "wall");

                        }
                        if (Map1[i, j] == "f")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32),finishRef , "finish");

                        }
                    }
                }
            }

            if (level == 2)
            {
              

                for (int i = 0; i < Map2.GetLength(0); i++)
                {
                    for (int j = 0; j < Map2.GetLength(1); j++)
                    {
                        if (Map2[i, j] == "p")
                        {
                            player = new Sprite2D(new Vector2(32, 32), new Vector2(30, 30), playerRef, "Player");
                        }

                        if (Map2[i, j] == "w")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32), wallRef, "wall");

                        }
                        if (Map2[i, j] == "f")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32), finishRef, "finish");

                        }
                     

                    }
                }
            }

            if (level == 3)
            {


                for (int i = 0; i < Map3.GetLength(0); i++)
                {
                    for (int j = 0; j < Map3.GetLength(1); j++)
                    {
                        if (Map3[i, j] == "p")
                        {
                            player = new Sprite2D(new Vector2(32, 32), new Vector2(30, 30), playerRef, "Player");
                        }

                        if (Map3[i, j] == "w")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32), wallRef, "wall");

                        }
                        if (Map3[i, j] == "f")
                        {

                            new Sprite2D(new Vector2(j * 32, i * 32), new Vector2(32, 32), finishRef, "finish");

                        }


                    }
                }
            }
        }


        public override void OnDraw()
        {
           

        }




        int times;
   
        public override void OnUpdate()
        {
            if(up)
            {
                player.Position.Y -= 5f;
            }
            if (down)
            {
                player.Position.Y += 5f;
            }
            if (left)
            {
                player.Position.X -= 5f;
            }
            if (right)
            {
                player.Position.X += 5f;
            }
            if(player.IsColliding("wall"))
            {
                Log.Info($"COLLIDING! {times}");
                times++;

                player.Position.X = lastPos.X;
                player.Position.Y = lastPos.Y;

            }
            else
            {
                lastPos.X = player.Position.X;
                lastPos.Y = player.Position.Y;

            }
            if (player.IsColliding("finish"))
            {
                level++;
                if (level <= 3)
                {
                    
                    AllSprites.Clear();
                    OnLoad();
                }
                if (level == 4)
                {
                    AllSprites.Clear();
                    zwyciestwo = true;
                }
                
            }
        }

        public override void GetKeyDown(KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Up) { up = true; }
            if (e.KeyCode == Keys.Down) { down = true; }
            if (e.KeyCode == Keys.Left) { left = true; }
            if (e.KeyCode == Keys.Right) { right = true; }

        }

        public override void GetKeyUp(KeyEventArgs e)
        {
            if (e.KeyCode == Keys.Up) { up = false; }
            if (e.KeyCode == Keys.Down) { down = false; }
            if (e.KeyCode == Keys.Left) { left = false; }
            if (e.KeyCode == Keys.Right) { right = false; }
        }
    }
}
